<?xml version="1.0"?>
<launch>

    <!-- Visual SLAM -->
    <!-- Remove "delete_db_on_start" to build on an existing map, saved in ~/.ros/rtabmap.db-->
    <node name="rtabmap" pkg="rtabmap_ros" type="rtabmap" output="screen" args="--delete_db_on_start">
        <param name="subscribe_depth" type="bool" value="true"/>
        <param name="subscribe_laserScan" type="bool" value="true"/>

        <remap from="rgb/image" to="/zed/zed_node/left/image_rect"/>
        <remap from="rgb/camera_info" to="/zed/zed_node/left/camera_info"/>
        <remap from="depth/image" to="/zed/zed_node/depth"/>
        <remap from="/rtabmap/odom" to="/odometry/filtered"/>
        <remap from="scan" to="/scan_filtered"/>

        <param name="frame_id" type="string" value="/base_link"/>
        <param name="queue_size" type="int" value="30"/>

        <param name="Vis/MinInliers" type="string" value="12"/>
        <param name="RGBD/CreateOccupancyGrid" type="string" value="true"/>

        <!-- Deals with the "large angular variance error". Hard coded solution from rtab creator. Fix later-->
        <param name="odom_frame_id" value="odom"/> <!-- adjust to actual odometry frame id -->
        <param name="odom_tf_linear_variance" value="0.0001"/> <!-- adjust depending on real odom error -->
        <param name="odom_tf_angular_variance" value="0.0005"/> <!-- adjust depending on real odom error -->
    </node>
 

</launch>
